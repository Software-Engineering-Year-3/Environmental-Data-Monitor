<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:vm="clr-namespace:ED_Monitor.ViewModels"
    x:Class="ED_Monitor.Pages.AirQualityPage"
    Title="Air Quality">

  <!-- Wire up the viewmodel directly in XAML -->
  <ContentPage.BindingContext>
    <vm:AirQualityViewModel />
  </ContentPage.BindingContext>

  <ScrollView>
    <VerticalStackLayout Padding="20" Spacing="15">

       <!-- Page header -->
      <Label Text="Air Quality Measurements"
             FontSize="24"
             HorizontalOptions="Center" />

      <!-- Show a spinner while data is loading -->
      <ActivityIndicator
        IsRunning="{Binding IsLoading}"
        IsVisible="{Binding IsLoading}"
        HorizontalOptions="Center" />

 <!-- Display each measurement or show an empty-state message -->
      <CollectionView ItemsSource="{Binding Measurements}"
                      EmptyView="No data available.">
        <CollectionView.ItemTemplate>
          <DataTemplate>
            <Frame BorderColor="Gray"
                   CornerRadius="5"
                   Padding="10"
                   Margin="5">
              <VerticalStackLayout Spacing="5">
                <Label Text="{Binding Date}" FontAttributes="Bold" />
                <Label Text="{Binding Time}" />
                <Label Text="{Binding NO2, StringFormat='NO₂: {0}'}" />
                <Label Text="{Binding SO2, StringFormat='SO₂: {0}'}" />
                <Label Text="{Binding PM25, StringFormat='PM2.5: {0}'}" />
                <Label Text="{Binding PM10, StringFormat='PM10: {0}'}" />
              </VerticalStackLayout>
            </Frame>
          </DataTemplate>
        </CollectionView.ItemTemplate>
      </CollectionView>
    </VerticalStackLayout>
  </ScrollView>
</ContentPage>
